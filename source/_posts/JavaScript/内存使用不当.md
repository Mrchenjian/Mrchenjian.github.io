---
title: 内存使用不当
top: false
cover: false
toc: true
mathjax: true
date: 2020-03-27 15:11:22
password: false
summary: false
tags:
categories:
- JavaScript

---

**内存查看**

浏览器： window.performance
node:   process.memoryUsage();

**V8内存的分配**

新生代内存空间
老生代内存空间

JavaScript回收得时候，会中断执行 jascript得设计是为了跑前端脚本-不持续，一执行就没了
**内存的大小**
和操作系统有关64位为1.4G，32位为0.7G

64位下新生代的空间为64MB，老生代为1400MB。

32位下新生代的空间为16MB，老生代为700MB

**容易引发内存使用不当的情景**
- 滥用全局变量    	一定要手动释放 变量=undefined
- 缓存是优化的小帮手   但是要设置 缓存索
````js
        var a=[];
        for(var i=0; i<15; i++){
            if(a.length>4){
                a.shift();
            }
            a.push(new Array(size));
        }
````
- 前端大文件上传         切片上传
- node 端 读取  会出现内存问题   不要用readfile
````js
                fs.readfile()
````
解决方案：   创建一个 readStream  以流的形式